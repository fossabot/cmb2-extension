window.CMB2Ext=window.CMB2Ext||{},function(e,a,b,t,n){"use strict";e.cmb2_ext_l10;var c=e.setTimeout;t.init=function(){b(a);var e=n.metabox();e.find(".cmb-repeatable-group");t.makeListSortable(),b(".cmb-ext-tab-nav").on("click",".cmb-ext-tab-nav-menu",t.toggleTabNav),b(a).on("widget-updated widget-added",t.makeListSortable),b(e).on("click",".cmb2-ext-buttonset-label",t.toggleButtonSelect).on("click",".cmb-ext-content-wrap-field-switch .button",t.initContentWrap).on("change.cmbAnimation",".cmb-type-animation select",t.animateOnChange).on("click.cmbAnimationPreview",".cmb-type-animation .cmb-ext-animation-preview-button",t.animateOnClick).on("click",'ul.cmb-image-select-list li input[type="radio"]',t.triggerImageSelect)},t.toggleTabNav=function(e){e.preventDefault();var t=b(this).parent(),a=t.data("panel"),n=t.parents(".cmb-tabs").find(".cmb-tabs-panel").find(".cmb-tab-panel-"+a);t.addClass("cmb-tab-active").siblings().removeClass("cmb-tab-active"),n.siblings().removeClass("show"),n.each(function(){b(this).addClass("show")})},t.initContentWrap=function(e){e.preventDefault();var t=b(this).closest(".cmb-ext-content-wrap");t.find("input").val(""),t.hasClass("cmb-ext-content-wrap-multiple")?(t.removeClass("cmb-ext-content-wrap-multiple").addClass("cmb-ext-content-wrap-single"),b(this).find("i").attr("class","dashicons dashicons-editor-expand")):(t.removeClass("cmb-ext-content-wrap-single").addClass("cmb-ext-content-wrap-multiple"),b(this).find("i").attr("class","dashicons dashicons-editor-contract"))},t.animateOnChange=function(e){var t=b(this).next(".cmb-ext-animation-preview-text");0<t.length&&(t.attr("class","cmb-ext-animation-preview-text animated"),t.addClass(b(this).val()))},t.animateOnClick=function(e){var t=b(this),a=t.next(".cmb-ext-animation-preview-text"),n=a.attr("class").replace("cmb-ext-animation-preview-text",""),i=t.prev("select").val();if(""===n&&""===i)return!1;""!==i&&(n=i+" animated"),a.attr("class","cmb-ext-animation-preview-text"),c(function(){a.addClass(n)},100)},t.makeListSortable=function(){var e=n.metabox().find(".sortable-list-ext");e.length&&e.sortable({handle:"span",placeholder:"ui-state-highlight",forcePlaceholderSize:!0}).disableSelection()},t.triggerImageSelect=function(e){e.stopPropagation(),b(this).closest("ul").find(".cmb-image-select-selected").removeClass("cmb-image-select-selected"),b(this).parent().closest("li").addClass("cmb-image-select-selected")},t.toggleButtonSelect=function(){var e=b(this).parents(".cmb2-ext-buttonset");b(".cmb2-ext-buttonset-label",e).removeClass("selected"),b(this).addClass("selected")},b(".cmb-type-font select").each(function(){b(this).higooglefonts({theme:"default cmb-ext-font-select2",selectedCallback:function(e){console.log(e)},loadedCallback:function(e){console.log(e),b("#paragraph").css("font-family",e)}})}),b(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker({theme:"fip-grey"})}),b(".cmb-repeatable-group").on("cmb2_add_group_row_start",function(e,t){b(a.getElementById(b(t).data("selector"))).find(".cmb-repeatable-grouping").last().find(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker().destroyPicker()})}),b(".cmb-repeatable-group").on("cmb2_add_row",function(e,t){b(t).find(".cmb-ext-iconselect").each(function(){b("option:selected",this).removeAttr("selected"),b(this).fontIconPicker().refreshPicker({theme:"fip-grey"})}),b(t).prev().find(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker().refreshPicker({theme:"fip-grey"})})}),b(".cmb-repeatable-group").on("cmb2_shift_rows_start",function(e,t){b(t).closest(".cmb-repeatable-group").find(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker().destroyPicker()})}),b(".cmb-repeatable-group").on("cmb2_shift_rows_complete",function(e,t){b(t).closest(".cmb-repeatable-group").find(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker().refreshPicker({theme:"fip-grey"})})}),b(".cmb-add-row-button").on("click",function(e){b(a.getElementById(b(e.target).data("selector"))).find(".cmb-row").last().find(".cmb-ext-iconselect").each(function(){b(this).fontIconPicker().destroyPicker()})}),b(".cmb-repeat-table").on("cmb2_add_row",function(e,t){b(t).prev().find(".cmb-ext-iconselect").each(function(){b("option:selected",this).removeAttr("selected"),b(this).fontIconPicker().refreshPicker({theme:"fip-grey"})})});var u=[];function i(e){var t=e.find(".pw-map-search"),a=e.find(".pw-map"),n=e.find(".pw-map-latitude"),i=e.find(".pw-map-longitude"),c=e.find(".pw-map-formatted_address"),s=new google.maps.LatLng(54.800685,-4.130859),o=5;0<n.val().length&&0<i.val().length&&(s=new google.maps.LatLng(n.val(),i.val()),o=17);var r={center:s,zoom:o},l=new google.maps.Map(a[0],r),d={map:l,draggable:!0,title:"Drag to set the exact location"},m=new google.maps.Marker(d);0<n.val().length&&0<i.val().length&&m.setPosition(s);var p=new google.maps.places.Autocomplete(t[0]);p.bindTo("bounds",l),google.maps.event.addListener(p,"place_changed",function(){var e=p.getPlace();e.geometry&&(e.geometry.viewport?l.fitBounds(e.geometry.viewport):(l.setCenter(e.geometry.location),l.setZoom(17)),m.setPosition(e.geometry.location),n.val(e.geometry.location.lat()),i.val(e.geometry.location.lng()),c.val(e.formatted_address))}),b(t).keypress(function(e){13===e.keyCode&&e.preventDefault()}),google.maps.event.addListener(m,"drag",function(){n.val(m.getPosition().lat()),i.val(m.getPosition().lng())}),u.push(l)}function s(e){e.each(function(){var e=b(this),a=e.find(".cmb-type-range-slider-field-value"),t=e.find(".cmb-type-range-slider-field"),n=e.find(".cmb-type-range-slider-field-value-text"),i=a.data();t.slider({range:"min",value:i.start,min:i.min,max:i.max,step:i.step,slide:function(e,t){a.val(t.value),n.text(t.value)}}),a.val(t.slider("value")),n.text(t.slider("value"))})}function o(){b('.cmb-ext-ajax-search:not([data-ajax-search="true"])').each(function(){b(this).attr("data-ajax-search",!0);b(this).attr("id");var t=b(this).attr("id").replace(new RegExp("_input$"),""),e=b(this).attr("data-object-type"),a=b(this).attr("data-query-args");b(this).devbridgeAutocomplete(Object.assign({serviceUrl:cmb2_ext_l10.ajaxurl,type:"POST",triggerSelectOnValidInput:!1,showNoSuggestionNotice:!0,params:{action:"cmb_ajax_search_get_results",nonce:cmb2_ext_l10.nonce,field_id:t,object_type:e,query_args:a},transformResult:function(e){var a=b.parseJSON(e);if(b("#"+t+"_results li").length){var n=[],i=0;b("#"+t+"_results input").each(function(e,t){n.push(b(this).val())}),b(a).each(function(e,t){-1<b.inArray(t.id.toString(),n)&&(a.splice(e-i,1),i++)})}return{suggestions:a}},onSearchStart:function(){b(this).next("img.cmb-ext-ajax-search-spinner").css("display","inline-block")},onSearchComplete:function(){b(this).next("img.cmb-ext-ajax-search-spinner").hide()},onSelect:function(e){b(this).devbridgeAutocomplete("clearCache");var t=b(this).attr("id").replace(new RegExp("_input$"),""),a=b(this).attr("data-multiple"),n=parseInt(b(this).attr("data-limit")),i=b(this).attr("data-sortable");1==a?(b("#"+t+"_results").append("<li>"+(1==i?'<span class="hndl"></span>':"")+'<input type="hidden" name="'+t+'[]" value="'+e.id+'"><a href="'+e.link+'" target="_blank" class="edit-link">'+e.value+'</a><a class="remover"><span class="dashicons dashicons-no"></span><span class="dashicons dashicons-dismiss"></span></a></li>'),b(this).val(""),0<n&&n==b("#"+t+"_results li").length?b(this).prop("disabled","disabled"):b(this).focus()):b("input[name="+t+"]").val(e.id).change()}},cmb2_ext_l10.options)),1==b(this).attr("data-sortable")&&b("#"+t+"_results").sortable({handle:".hndl",placeholder:"ui-state-highlight",forcePlaceholderSize:!0})})}b(".cmb-type-pw-map").each(function(){i(b(this))}),"undefined"!=typeof postboxes&&(postboxes.pbshow=function(){for(var e=u.length,t=0;t<e;t++){var a=u[t].getCenter();google.maps.event.trigger(u[t],"resize"),u[t].setCenter(a)}}),b(".cmb-repeatable-group").on("cmb2_add_row",function(e,t){b(t).closest(".cmb-repeatable-group").find(".cmb-type-pw-map").each(function(){i(b(this))})}),b(".cmb-type-range-slider").each(function(){s(b(this))}),b(".cmb-repeatable-group").on("cmb2_shift_rows_complete",function(e,t){return b(t).closest(".cmb-repeatable-group").find(".cmb-type-range-slider").each(function(){b(this).find(".cmb-type-range-slider-field").slider("value",b(this).find(".cmb-type-range-slider-field-value").val()),b(this).find(".cmb-type-range-slider-field-value-text").text(b(this).find(".cmb-type-range-slider-field-value").val())}),!1}),b(".cmb-repeatable-group").on("cmb2_add_row",function(e,t){return b(t).find(".cmb-type-own-slider").each(function(){s(b(this)),b(this).find(".ui-slider-range").css("width",0),b(this).find(".cmb-type-range-slider-field").slider("value",0),b(this).find(".cmb-type-range-slider-field-value-text").text("0")}),!1}),o(),b(a).on("cmb2_add_row",function(e,t){t.find(".cmb-ext-ajax-search").attr("data-ajax-search",!1),o()}),b(a).on("widget-updated widget-added",function(){o()}),b("body").on("click",".cmb-ext-ajax-search-results a.remover",function(){b(this).parent("li").fadeOut(400,function(){var e=b(this).parents("ul").attr("id").replace("_results","");b("#"+e).removeProp("disabled"),b("#"+e).devbridgeAutocomplete("clearCache"),b(this).remove()})}),b(t.init)}(window,document,jQuery,window.CMB2Ext,window.CMB2);